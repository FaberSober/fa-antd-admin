# 表结构

# **表结构说明**

> 引擎核心仅 8 张表实现逻辑数据存储、采用 JSON 数据格式存储模型结构简洁直观。
> 
- 英文字母 `flw` 为 `flowlong workflow` 飞龙工作流的缩写

# **核心表关系结构图**

![](https://flowlong.aizuda.com/imgs/dbRel.png)

# **流程定义表 flw_process**

- 用于存储流程模型信息

| **字段** | **描述** |
| --- | --- |
| id | 主键ID |
| tenant_id | 租户ID |
| create_id | 创建人ID |
| create_by | 创建人名称 |
| create_time | 创建时间 |
| process_key | 流程定义 key 唯一标识 |
| process_name | 流程定义名称 |
| process_icon | 流程图标地址 |
| process_type | 流程类型 |
| process_version | 流程版本，默认 1 |
| instance_url | 实例地址（外置表单发起地址） |
| remark | 备注说明 |
| use_scope | 使用范围 0，全员 1，指定人员（业务关联） 2，均不可提交 |
| process_state | 流程状态 0，不可用 1，可用 2，历史版本 |
| model_content | 流程模型定义JSON内容 |
| sort | 排序 |

# **流程实例表 flw_instance**

- 记录每一次启动执行流程模型的具体实例信息

| **字段** | **描述** |
| --- | --- |
| id | 主键ID |
| tenant_id | 租户ID |
| create_id | 创建人ID |
| create_by | 创建人名称 |
| create_time | 创建时间 |
| process_id | 流程定义ID |
| parent_instance_id | 父流程实例ID |
| priority | 优先级 |
| instance_no | 流程实例编号 |
| business_key | 业务KEY |
| variable | 变量json |
| current_node_name | 当前所在节点名称 |
| current_node_key | 当前所在节点key |
| expire_time | 期望完成时间 |
| last_update_by | 上次更新人 |
| last_update_time | 上次更新时间 |

# **历史流程实例表 flw_his_instance**

- 流程实例表的历史记录，每次生成实例信息同时记录该表，该表继承流程实例表字段的基础上增加 `状态` `结束时间` `处理耗时` 字段。

| **字段** | **描述** |
| --- | --- |
| instance_state | 状态 0，审批中 1，审批通过 2，审批拒绝 3，撤销审批 4，超时结束 5，强制终止 |
| end_time | 结束时间 |
| duration | 处理耗时 |

# **扩展流程实例表 flw_ext_instance**

- 扩展流程实例功能表，例如 `modelContent` 用于支持动态添加节点存储临时模型。

| **字段** | **描述** |
| --- | --- |
| id | 主键ID |
| tenant_id | 租户ID |
| process_id | 流程定义ID |
| instance_id | 程实例ID |
| process_name | 流程名称 |
| process_type | 流程类型 |
| model_content | 流程模型定义JSON内容 |

# **任务表 flw_task**

- 流程实例执行阶段的具体执行任务信息

| **字段** | **描述** |
| --- | --- |
| id | 主键ID |
| tenant_id | 租户ID |
| create_id | 创建人ID |
| create_by | 创建人名称 |
| create_time | 创建时间 |
| instance_id | 流程实例ID |
| parent_task_id | 父任务ID |
| task_name | 任务名称 |
| task_key | 任务 key 唯一标识 |
| task_type | 任务类型 |
| perform_type | 参与类型 |
| action_url | 任务处理的url |
| variable | 变量json |
| assignor_id | 委托人ID |
| assignor | 委托人 |
| expire_time | 任务期望完成时间 |
| remind_time | 提醒时间 |
| remind_repeat | 提醒次数 |
| viewed | 已阅 0，否 1，是 |

# **历史任务表 flw_his_task**

- 流程实例执行任务表的历史记录，每次生成任务信息同时记录该表，该表继承流程任务表字段的基础上增加 `完成时间` `任务状态` `处理耗时` 字段。

| **字段** | **描述** |
| --- | --- |
| call_process_id | 调用外部流程定义ID |
| call_instance_id | 调用外部流程实例ID |
| finish_time | 完成时间 |
| task_state | 任务状态 0，活动 1，跳转 2，完成 3，拒绝 4，撤销审批 5，超时 6，终止 7，驳回终止 |
| duration | 处理耗时 |

# **任务参与者表 flw_task_actor**

- 流程实例执行任务具体任务参与者信息，用于存储实时任务参与者关联信息。

| **字段** | **描述** |
| --- | --- |
| id | 主键ID |
| tenant_id | 租户ID |
| instance_id | 流程实例ID |
| task_id | 任务ID |
| actor_id | 参与者ID |
| actor_name | 参与者名称 |
| actor_type | 参与者类型 0，用户 1，角色 2，部门 |
| weight | 权重，票签任务时，该值为不同处理人员的分量比例，代理任务时，该值为 1 时为代理人 2时或签处理人 |
| agent_id | 代理人ID |
| agent_type | 代理人类型 0，代理 1，被代理 2，认领角色 3，认领部门 |
| extend | 扩展json |

# **历史任务参与者表 flw_his_task_actor**

- 流程实例执行任务具体任务参与者信息历史表，该表和表 `flw_task_actor` 的表结构一致，用于存储历史任务参与者关联信息。

**提示！**

如下问题还是无法解决您的疑惑，可以添加微信 `wx153666` 备注 `flowlong` 进入微信官方群交流。